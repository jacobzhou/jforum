<div class="box">
  <div class="cell">
    <div class="pull">
      <%= link_to '返回健康问卷管理', admin_surveys_path, :class => :btn %>
      <%= build_admin_navigation([@title]) %>
    </div>
  </div>
  <div class="cell">
    <%= simple_nested_form_for [:admin, @survey], :html => {:class => 'form-horizontal'} do |f| %>
      <%= f.input :name %>
      <table class="table table-bordered" id="questions">
        <tr>
          <th>标题</th>
          <th>类型</th>
          <th>选项</th>
          <th>排序</th>
          <th>操作</th>
        </tr>
        <%= f.simple_fields_for :survey_questions do |nest_form| %>
          <tr>
            <td><%= nest_form.input_field :title %></td>
            <td><%= nest_form.input_field :qtype, :collection => DataDict.qtypes, :include_blank => false %></td>
            <td><%= nest_form.input_field :options %></td>
            <td><%= nest_form.input_field :position, :input_html => {} %></td>
            <td><%= nest_form.link_to_remove "删除", :class => "btn btn-small btn-warning" %></td>
          </tr>
        <% end -%>
        <%= f.link_to_add "添加问题", :survey_questions, :class => "btn ml180", :data => { :target => "#questions" }%>
      </table>
      <div class="form-actions">
        <%= f.submit '保存', :class => 'btn btn-small btn-primary' %>
      </div>
    <% end -%>
  </div>
</div>
<script type="text/javascript">
  $(document).ready( function() {
    add_index_to_fields();
  });
</script>
